# Tag2 å·¥ä½œè®¡åˆ’ - æ¨¡å¼è¯†åˆ«ç³»ç»Ÿä¼˜åŒ–

## ğŸ“Œ å½“å‰çŠ¶æ€

**æœ€åæ›´æ–°**: 2025-12-10

**å½“å‰é˜¶æ®µ**: é˜¶æ®µä¸‰è„šæœ¬å·²å®Œæˆï¼Œå¾…æ‰§è¡Œæ•°æ®å¤„ç†

**å·²å®Œæˆ**:
- âœ… å®Œæˆåœºæ™¯ä¸€ã€åœºæ™¯äºŒçš„æ–¹æ¡ˆè®¨è®º
- âœ… ç¡®å®šé‡‡ç”¨ã€æ–¹æ¡ˆD+Eç»„åˆã€‘ï¼šç»å…¸æ¨¡å¼+AIå‘ç°æ–°æ¨¡å¼
- âœ… ç¼–å†™æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ–‡æ¡£ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘.mdï¼‰
- âœ… ç¼–å†™å·¥ä½œè®¡åˆ’æ–‡æ¡£ï¼ˆå·¥ä½œè®¡åˆ’.mdï¼‰
- âœ… å°†æ–¹æ¡ˆæ›´æ–°åˆ°æ¦‚è¦è®¾è®¡ä¹¦ï¼ˆsystem_design_complete.html - é™„å½•Bï¼‰
- âœ… å®Œæˆä¸Opus 4.5çš„æ–¹æ¡ˆè®¨è®ºå’Œè´¹ç”¨ä¼˜åŒ–
- âœ… **é˜¶æ®µé›¶**ï¼šå®šä¹‰3ä¸ªç»å…¸æ¨¡å¼ã€ä¿®æ”¹æ•°æ®åº“ç»“æ„
- âœ… **é˜¶æ®µä¸€**ï¼šå®ç°ç»å…¸æ¨¡å¼åŒ¹é…å‡½æ•°ã€ä¿å­˜å‡½æ•°
- âœ… **é˜¶æ®µäºŒ**ï¼šæ•°æ®å‡†å¤‡å·¥å…·ï¼ˆKçº¿ä¸Šä¸‹æ–‡å‡½æ•°ã€è¿‡æ»¤è„šæœ¬ï¼‰
- âœ… **é˜¶æ®µä¸‰**ï¼šAIåˆ†ç±»ã€æå–ã€åˆå¹¶è„šæœ¬
- âœ… **é˜¶æ®µå››**ï¼šéªŒè¯å‡†å¤‡ï¼ˆç¨‹åºé¢„ç­›é€‰åŠŸèƒ½ï¼‰
- âœ… **é˜¶æ®µäº”**ï¼šå†å²å›æµ‹éªŒè¯è„šæœ¬
- âœ… **é˜¶æ®µå…­**ï¼šå®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨

**å¾…å®Œæˆ**:
- â³ è¿è¡Œé˜¶æ®µäºŒè„šæœ¬ï¼šç”Ÿæˆ300æ ·æœ¬ã€è¿‡æ»¤ç»å…¸æ ·æœ¬
- â³ è¿è¡Œé˜¶æ®µä¸‰è„šæœ¬ï¼šAIåˆ†ç±»ã€æå–æ–°æ¨¡å¼ã€åˆå¹¶åˆ°æ•°æ®åº“ï¼ˆ$3.30ï¼‰
- â³ è¿è¡Œé˜¶æ®µäº”è„šæœ¬ï¼šå†å²å›æµ‹éªŒè¯å‡†ç¡®ç‡
- â³ é…ç½®å’Œå¯åŠ¨å®šæ—¶ä»»åŠ¡

**ä¸‹æ¬¡å¼€å§‹**: è¿è¡Œ filter_classic_samples.py ç”Ÿæˆç‰¹æ®Šæ ·æœ¬æ•°æ®ï¼ˆéœ€ç¡®ä¿æ•°æ®åº“æœ‰æ•°æ®ï¼‰

---

## ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°ï¼šæ–¹æ¡ˆD+Eç»„åˆ

### æ ¸å¿ƒæ€è·¯
1. **3ä¸ªç»å…¸æ¨¡å¼**ï¼ˆç¨‹åºå®šä¹‰ï¼Œ$0ï¼‰ï¼šç¼©é‡éœ‡è¡çªç ´ã€Vå‹åè½¬ã€è¿ç»­æ”¾é‡
2. **1-2ä¸ªAIæ–°æ¨¡å¼**ï¼ˆAIå‘ç°ï¼Œ$3.30ï¼‰ï¼šä»éç»å…¸æ ·æœ¬ä¸­ç”¨Sonnetæå–
3. **ç¨‹åºé¢„ç­›é€‰**ï¼ˆé™ä½æˆæœ¬ï¼‰ï¼šç”¨é‡åŒ–å‚æ•°å…ˆç­›é€‰ï¼Œå†AIéªŒè¯

### æœˆåº¦æˆæœ¬
- åœºæ™¯ä¸€ï¼ˆæ¯æœˆ1æ¬¡ï¼‰: **$3.30**
- åœºæ™¯äºŒï¼ˆæ¯æ—¥è¿è¡Œï¼‰: **$0.30**
- **æœˆåº¦æ€»è®¡: $3.60**

### é¢„æœŸè¾“å‡º
- 4-5ä¸ªé«˜è´¨é‡ä¸Šæ¶¨æ¨¡å¼ï¼ˆ3ä¸ªç»å…¸+1-2ä¸ªAIå‘ç°ï¼‰
- æ¯ä¸ªæ¨¡å¼åŒ…å«ï¼šé‡åŒ–å‚æ•°ã€å…³é”®ç‰¹å¾ã€åŒ¹é…è§„åˆ™
- å†å²å›æµ‹éªŒè¯çš„å‡†ç¡®ç‡æ•°æ®

---

## ğŸ“‹ å®æ–½è®¡åˆ’æ—¶é—´è¡¨

| é˜¶æ®µ | ä»»åŠ¡ | å·¥ä½œé‡ | è´¹ç”¨ | çŠ¶æ€ |
|------|------|--------|------|------|
| **é˜¶æ®µé›¶** | å‡†å¤‡å·¥ä½œï¼ˆå®šä¹‰ç»å…¸æ¨¡å¼ã€ä¿®æ”¹æ•°æ®åº“ï¼‰ | 0.5å¤© | $0 | âœ… å·²å®Œæˆ |
| **é˜¶æ®µä¸€** | ç»å…¸æ¨¡å¼è½åœ°ï¼ˆåŒ¹é…å‡½æ•°ã€å†™å…¥æ•°æ®åº“ï¼‰ | 0.5å¤© | $0 | âœ… å·²å®Œæˆ |
| **é˜¶æ®µäºŒ** | æ•°æ®å‡†å¤‡ï¼ˆç”Ÿæˆ300æ ·æœ¬ã€è¿‡æ»¤ç»å…¸ï¼‰ | 1å¤© | $0 | âœ… å·²å®Œæˆ |
| **é˜¶æ®µä¸‰** | AIå‘ç°æ–°æ¨¡å¼ï¼ˆHaikuåˆ†ç±»+Sonnetæå–ï¼‰ | 0.5å¤© | **$3.30** | âœ… å·²å®Œæˆ |
| **é˜¶æ®µå››** | éªŒè¯å‡†å¤‡ï¼ˆç¨‹åºé¢„ç­›é€‰ã€AIåŒ¹é…ï¼‰ | 0.5å¤© | $0 | âœ… å·²å®Œæˆ |
| **é˜¶æ®µäº”** | å†å²å›æµ‹éªŒè¯ï¼ˆå›æµ‹+ç»Ÿè®¡å‡†ç¡®ç‡ï¼‰ | 1å¤© | $0 | âœ… å·²å®Œæˆ |
| **é˜¶æ®µå…­** | ä¸Šçº¿è¿è¡Œï¼ˆå®šæ—¶ä»»åŠ¡ã€ç›‘æ§ï¼‰ | 0.5å¤© | $0 | âœ… å·²å®Œæˆ |
| **æ€»è®¡** | - | **4.5å¤©** | **$3.30** | - |

---

## ğŸ”§ å…³é”®æ”¹åŠ¨ç‚¹ï¼ˆvså½“å‰å®ç°ï¼‰

### 1. æ•°æ®åº“æ”¹åŠ¨

**æ–‡ä»¶**: `backend/app/database.py`

**æ–°å¢å­—æ®µ** (rising_patternsè¡¨):
```sql
ALTER TABLE rising_patterns ADD COLUMN pattern_id TEXT;
ALTER TABLE rising_patterns ADD COLUMN pattern_type TEXT;  -- 'classic' or 'ai_discovered'
ALTER TABLE rising_patterns ADD COLUMN parameters TEXT;    -- JSONæ ¼å¼çš„é‡åŒ–å‚æ•°
ALTER TABLE rising_patterns ADD COLUMN match_rules TEXT;   -- JSONæ ¼å¼çš„åŒ¹é…è§„åˆ™
ALTER TABLE rising_patterns ADD COLUMN is_active BOOLEAN DEFAULT 1;
```

**ä¿®æ”¹å‡½æ•°**: `get_rising_samples()`ï¼ˆçº¦line 187-217ï¼‰
- å½“å‰ï¼šåªæœ‰æ¶¨å¹…â‰¥8%ä¸€ä¸ªæ¡ä»¶
- æ”¹ä¸ºï¼šæ¶¨å¹…â‰¥6% + æˆäº¤é‡â‰¥1.8å€ + æœ€è¿‘åŠå¹´ + æ’é™¤ST + å½“æ—¥æ¶¨å¹…>1%

### 2. æ–°å»ºæ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `classic_patterns.json` | 3ä¸ªç»å…¸æ¨¡å¼å®šä¹‰ |
| `backend/app/pattern_matcher.py` | ç¨‹åºåŒ–æ¨¡å¼åŒ¹é…å‡½æ•° |
| `backend/scripts/filter_classic_samples.py` | è¿‡æ»¤ç»å…¸æ ·æœ¬è„šæœ¬ |
| `backend/scripts/classify_special_samples.py` | Haikuåˆ†ç±»è„šæœ¬ï¼ˆ$0.80ï¼‰ |
| `backend/scripts/extract_new_patterns.py` | Sonnetæå–æ–°æ¨¡å¼è„šæœ¬ï¼ˆ$2.50ï¼‰ |
| `backend/scripts/merge_patterns.py` | åˆå¹¶æ¨¡å¼åˆ°æ•°æ®åº“ |
| `backend/scripts/backtest_patterns.py` | å†å²å›æµ‹è„šæœ¬ |
| `backend/app/scheduler.py` | å®šæ—¶ä»»åŠ¡ï¼ˆæ¯æ—¥éªŒè¯ã€æ¯å‘¨ç»Ÿè®¡ï¼‰ |

### 3. ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | æ”¹åŠ¨å†…å®¹ |
|------|---------|
| `backend/app/database.py` | æ–°å¢å­—æ®µã€ä¿®æ”¹get_rising_samples()ã€æ–°å¢get_samples_with_context() |
| `backend/app/analyzer.py` | ä¿®æ”¹validate_patterns()ï¼ŒåŠ å…¥ç¨‹åºé¢„ç­›é€‰ |

---

## ğŸ“ å„é˜¶æ®µè¯¦ç»†ä»»åŠ¡

### é˜¶æ®µé›¶ï¼šå‡†å¤‡å·¥ä½œï¼ˆ0.5å¤©ï¼‰

#### ä»»åŠ¡0.1ï¼šå®šä¹‰3ä¸ªç»å…¸æ¨¡å¼

**åˆ›å»ºæ–‡ä»¶**: `classic_patterns.json`

**å†…å®¹**:
- P001: ç¼©é‡éœ‡è¡åæ”¾é‡çªç ´
- P002: Vå‹åè½¬æ”¾é‡ä¸Šæ”»
- P003: è¿ç»­æ”¾é‡ä¸Šæ”»

**éªŒæ”¶**: 3ä¸ªæ¨¡å¼å®šä¹‰æ¸…æ™°ï¼Œparameterså¯ç¼–ç¨‹éªŒè¯

---

#### ä»»åŠ¡0.2ï¼šä¿®æ”¹æ•°æ®åº“ç»“æ„

**æ–‡ä»¶**: `backend/app/database.py`

**æ”¹åŠ¨1**: æ‰©å±•rising_patternsè¡¨ï¼ˆ5ä¸ªæ–°å­—æ®µï¼‰

**æ”¹åŠ¨2**: ä¿®æ”¹get_rising_samples()å‡½æ•°çš„WHEREæ¡ä»¶

**å·¥ä½œé‡**: 2å°æ—¶

---

### é˜¶æ®µä¸€ï¼šç»å…¸æ¨¡å¼è½åœ°ï¼ˆ0.5å¤©ï¼‰

#### ä»»åŠ¡1.1ï¼šå®ç°ç»å…¸æ¨¡å¼åŒ¹é…å‡½æ•°

**æ–°å»º**: `backend/app/pattern_matcher.py`

**æ ¸å¿ƒå‡½æ•°**: `match_classic_patterns(stock_kline_data, classic_patterns)`

**å·¥ä½œé‡**: 3å°æ—¶

---

#### ä»»åŠ¡1.2ï¼šå°†ç»å…¸æ¨¡å¼å†™å…¥æ•°æ®åº“

**æ–‡ä»¶**: `backend/app/database.py`

**æ–°å‡½æ•°**: `save_classic_patterns()`

**å·¥ä½œé‡**: 30åˆ†é’Ÿ

---

### é˜¶æ®µäºŒï¼šæ•°æ®å‡†å¤‡ï¼ˆ1å¤©ï¼‰

#### ä»»åŠ¡2.1ï¼šç”Ÿæˆ300ä¸ªé«˜è´¨é‡è®­ç»ƒæ ·æœ¬

**æ‰§è¡Œ**: `db.get_rising_samples(sample_count=300, rise_threshold=0.06)`

**è¾“å‡º**: ä¿å­˜åˆ°ä¸´æ—¶è¡¨ `training_samples_tag2`

**å·¥ä½œé‡**: 1å°æ—¶

---

#### ä»»åŠ¡2.2ï¼šè¡¥å……20å¤©Kçº¿ä¸Šä¸‹æ–‡

**æ–°å‡½æ•°**: `get_samples_with_context(sample_ids, days_before=20)`

**å·¥ä½œé‡**: 2å°æ—¶

---

#### ä»»åŠ¡2.3ï¼šç”¨ç»å…¸æ¨¡å¼è¿‡æ»¤æ ·æœ¬

**æ–°å»º**: `backend/scripts/filter_classic_samples.py`

**ç›®æ ‡**: ä»300ä¸ªæ ·æœ¬ä¸­æ‰¾å‡ºä¸ç¬¦åˆç»å…¸æ¨¡å¼çš„"ç‰¹æ®Šæ ·æœ¬"

**è¾“å‡º**: `special_samples.json`ï¼ˆ100-150ä¸ªï¼‰

**å·¥ä½œé‡**: 2å°æ—¶

---

### é˜¶æ®µä¸‰ï¼šAIå‘ç°æ–°æ¨¡å¼ï¼ˆ0.5å¤©ï¼Œ$3.30ï¼‰

#### ä»»åŠ¡3.1ï¼šHaikuå¿«é€Ÿåˆ†ç±»ï¼ˆ$0.80ï¼‰

**æ–°å»º**: `backend/scripts/classify_special_samples.py`

**è¾“å…¥**: `special_samples.json`ï¼ˆ100-150ä¸ªï¼‰

**AIæ¨¡å‹**: Haiku 3.5

**è¾“å‡º**: `sample_categories.json`ï¼ˆ2-3å¤§ç±»ï¼‰

**å·¥ä½œé‡**: 1å°æ—¶

---

#### ä»»åŠ¡3.2ï¼šSonnetæ·±åº¦åˆ†ææœ€å¤§ç±»ï¼ˆ$2.50ï¼‰

**æ–°å»º**: `backend/scripts/extract_new_patterns.py`

**è¾“å…¥**: æœ€å¤§ç±»çš„40-60ä¸ªæ ·æœ¬ + å®Œæ•´20å¤©Kçº¿

**AIæ¨¡å‹**: Sonnet 4.5

**è¾“å‡º**: `new_patterns.json`ï¼ˆ1-2ä¸ªæ–°æ¨¡å¼ï¼‰

**å·¥ä½œé‡**: 2å°æ—¶

---

#### ä»»åŠ¡3.3ï¼šåˆå¹¶æ¨¡å¼åˆ°æ•°æ®åº“

**æ–°å»º**: `backend/scripts/merge_patterns.py`

**æ“ä½œ**:
- è¯»å–classic_patterns.jsonï¼ˆ3ä¸ªï¼‰
- è¯»å–new_patterns.jsonï¼ˆ1-2ä¸ªï¼‰
- åˆå¹¶å†™å…¥rising_patternsè¡¨

**å·¥ä½œé‡**: 30åˆ†é’Ÿ

---

### é˜¶æ®µå››ï¼šéªŒè¯å‡†å¤‡ï¼ˆ0.5å¤©ï¼‰

#### ä»»åŠ¡4.1ï¼šå®ç°åœºæ™¯äºŒçš„ç¨‹åºé¢„ç­›é€‰

**æ–‡ä»¶**: `backend/app/pattern_matcher.py`

**æ–°å‡½æ•°**: `pre_screen_stocks(stocks_kline_data, patterns)`

**ä½œç”¨**: ä»100åªè‚¡ç¥¨ç­›é€‰åˆ°20-30åªå€™é€‰

**å·¥ä½œé‡**: 2å°æ—¶

---

#### ä»»åŠ¡4.2ï¼šå®ç°AIç²¾ç¡®åŒ¹é…

**æ–‡ä»¶**: `backend/app/analyzer.py`

**ä¿®æ”¹å‡½æ•°**: `validate_patterns()`

**æ”¹åŠ¨**: åŠ å…¥ç¨‹åºé¢„ç­›é€‰ â†’ å†AIéªŒè¯

**å·¥ä½œé‡**: 2å°æ—¶

---

### é˜¶æ®µäº”ï¼šå†å²å›æµ‹éªŒè¯ï¼ˆ1å¤©ï¼‰

#### ä»»åŠ¡5.1ï¼šå†å²æ•°æ®éªŒè¯

**æ–°å»º**: `backend/scripts/backtest_patterns.py`

**é€»è¾‘**:
- é€‰å–è¿‡å»3ä¸ªæœˆå†å²æ•°æ®
- æ¯å¤©æ¨¡æ‹Ÿè¿è¡Œåœºæ™¯äºŒ
- ç”¨ç¨‹åºåŒ¹é…ï¼ˆä¸ç”¨AIï¼Œçœé’±ï¼‰
- T+3éªŒè¯æ¶¨è·Œ

**è´¹ç”¨**: $0ï¼ˆçº¯ç¨‹åºéªŒè¯ï¼‰

**è¾“å‡º**: æ¯ä¸ªæ¨¡å¼çš„å†å²å‡†ç¡®ç‡

**å·¥ä½œé‡**: 4å°æ—¶

---

#### ä»»åŠ¡5.2ï¼šæ›´æ–°æ¨¡å¼å‡†ç¡®ç‡

**æ“ä½œ**: å°†å›æµ‹ç»“æœå†™å…¥æ•°æ®åº“ï¼Œæ·˜æ±°å‡†ç¡®ç‡<40%çš„æ¨¡å¼

**å·¥ä½œé‡**: 1å°æ—¶

---

### é˜¶æ®µå…­ï¼šä¸Šçº¿è¿è¡Œï¼ˆ0.5å¤©ï¼‰

#### ä»»åŠ¡6.1ï¼šåˆ›å»ºæ¯æ—¥å®šæ—¶ä»»åŠ¡

**æ–°å»º**: `backend/app/scheduler.py`

**åŠŸèƒ½**:
- æ¯æ—¥16:00è¿è¡Œåœºæ™¯äºŒ
- ç¨‹åºé¢„ç­›é€‰ â†’ AIéªŒè¯
- ä¿å­˜é¢„æµ‹ç»“æœ

**å·¥ä½œé‡**: 2å°æ—¶

---

#### ä»»åŠ¡6.2ï¼šåˆ›å»ºå‡†ç¡®ç‡ç»Ÿè®¡ä»»åŠ¡

**æ–‡ä»¶**: `backend/app/scheduler.py`

**åŠŸèƒ½**:
- æ¯å‘¨ä¸€æ›´æ–°æ¨¡å¼å‡†ç¡®ç‡
- æ·˜æ±°ä½å‡†ç¡®ç‡æ¨¡å¼

**å·¥ä½œé‡**: 2å°æ—¶

---

## ğŸ“Š å…³é”®å‚æ•°è®°å½•

### åœºæ™¯ä¸€ï¼šæ¨¡å¼æå–å‚æ•°

| å‚æ•° | é…ç½®å€¼ | ç†ç”± |
|------|--------|------|
| æ ·æœ¬é‡ | 300ä¸ª | å¹³è¡¡æˆæœ¬å’Œè¦†ç›–åº¦ |
| æ¶¨å¹…é˜ˆå€¼ | 6% | é€‚ä¸­æ ‡å‡† |
| æˆäº¤é‡æ¯”ä¾‹ | â‰¥1.8å€ | ç¡®ä¿èµ„é‡‘æ”¯æ’‘ |
| æ—¶é—´èŒƒå›´ | æœ€è¿‘åŠå¹´ | å¸‚åœºç¯å¢ƒä¸€è‡´æ€§ |
| ä¸Šä¸‹æ–‡å¤©æ•° | 20å¤© | è¯†åˆ«å½¢æ€+æ§åˆ¶æˆæœ¬ |
| AIæ¨¡å‹ï¼ˆåˆ†ç±»ï¼‰ | Haiku 3.5 | å¿«é€Ÿåˆ†ç±»ï¼Œçœé’± |
| AIæ¨¡å‹ï¼ˆæå–ï¼‰ | Sonnet 4.5 | æ·±åº¦åˆ†æï¼Œè´¨é‡ä¼˜å…ˆ |

### åœºæ™¯äºŒï¼šæ¨¡å¼éªŒè¯å‚æ•°

| å‚æ•° | é…ç½®å€¼ | ç†ç”± |
|------|--------|------|
| è‚¡ç¥¨æ±  | ä¸Šè¯50+180+380ï¼ˆçº¦600åªï¼‰ | å½“å‰ç³»ç»Ÿå·²æœ‰ |
| æ—¥å¸¸éªŒè¯æ•° | 100åª | å¹³è¡¡è¦†ç›–å’Œæˆæœ¬ |
| å†å²å¤©æ•° | 30å¤© | è¶³å¤Ÿè¯†åˆ«æ¨¡å¼ |
| AIæ¨¡å‹ | Haiku 3.5 | åŒ¹é…ä»»åŠ¡ï¼Œæ€§ä»·æ¯”ä¼˜å…ˆ |
| åŒ¹é…é˜ˆå€¼ | 70% | é¿å…è¯¯æŠ¥ |
| æœ€å°‘åŒ¹é…æ•° | 2ä¸ªæ¨¡å¼ | å¤šæ•°æŠ•ç¥¨æé«˜å¯ä¿¡åº¦ |
| éªŒè¯æ ‡å‡† | æ¶¨å¹…â‰¥5%ï¼ŒT+2æ—¥ | ä¸åœºæ™¯ä¸€ä¸€è‡´ |
| æ·˜æ±°é˜ˆå€¼ | å‡†ç¡®ç‡<40% | è¿‡æ»¤å¼±æ¨¡å¼ |

---

## ğŸ¯ ä¸‹æ¬¡å¼€å§‹å·¥ä½œæ—¶

### å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] æ£€æŸ¥å½“å‰åœ¨å“ªä¸ªé˜¶æ®µï¼ˆçœ‹ä¸Šé¢æ—¶é—´è¡¨çš„"çŠ¶æ€"åˆ—ï¼‰
- [ ] é˜…è¯»è¯¥é˜¶æ®µçš„è¯¦ç»†ä»»åŠ¡
- [ ] æŸ¥çœ‹éœ€è¦ä¿®æ”¹/åˆ›å»ºçš„æ–‡ä»¶
- [ ] ç¡®è®¤å·¥ä½œé‡å’Œè´¹ç”¨é¢„ç®—

### å…³é”®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ |
|------|------|
| æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ | `æ ¸å¿ƒä¸šåŠ¡é€»è¾‘.md` |
| æ•°æ®åº“æ“ä½œ | `backend/app/database.py` |
| å½“å‰ç³»ç»Ÿæ ·æœ¬ç­›é€‰ | `backend/app/database.py` line 187-217 |
| æ¦‚è¦è®¾è®¡ä¹¦ | ï¼ˆå¾…è¡¥å……HTMLæ–‡ä»¶è·¯å¾„ï¼‰ |
| å®éªŒæ€»ç»“ | `EXPERIMENT_SUMMARY.md` |

### å½“å‰ç³»ç»Ÿé—®é¢˜

1. âŒ SQLç­›é€‰åªæœ‰æ¶¨å¹…ä¸€ä¸ªæ¡ä»¶ï¼ˆå¯¼è‡´å™ªå£°å¤šï¼‰
2. âŒ AIæå–æ—¶åªç”¨3å¤©Kçº¿ï¼ˆæ— æ³•è¯†åˆ«å½¢æ€ï¼‰
3. âŒ ç”¨Haikuæå–æ¨¡å¼ï¼ˆå½’çº³èƒ½åŠ›ä¸è¶³ï¼‰
4. âŒ ç¼ºå°‘é‡åŒ–å‚æ•°ï¼ˆåœºæ™¯äºŒæ— æ³•ç¨‹åºé¢„ç­›é€‰ï¼‰
5. âŒ å®éªŒ3ï¼ˆ1000æ ·æœ¬ï¼‰å‡†ç¡®ç‡41% < å®éªŒ2ï¼ˆ500æ ·æœ¬ï¼‰å‡†ç¡®ç‡47%

### æ ¸å¿ƒæ”¹è¿›ç‚¹

1. âœ… æé«˜æ ·æœ¬è´¨é‡ï¼ˆå¤šç»´åº¦ç­›é€‰æ¡ä»¶ï¼‰
2. âœ… å¢åŠ Kçº¿ä¸Šä¸‹æ–‡ï¼ˆ20å¤©ï¼‰
3. âœ… ç»å…¸æ¨¡å¼+AIå‘ç°ï¼ˆå…¼é¡¾å¯è§£é‡Šæ€§å’Œåˆ›æ–°æ€§ï¼‰
4. âœ… è¾“å‡ºé‡åŒ–å‚æ•°ï¼ˆæ”¯æŒç¨‹åºé¢„ç­›é€‰ï¼‰
5. âœ… åˆ†æ‰¹æå–ï¼ˆHaikuåˆ†ç±»+Sonnetç²¾æå–ï¼Œçœé’±ï¼‰

---

## ğŸ“Œ å¾…åŠäº‹é¡¹

- [x] **é˜¶æ®µé›¶**: å®šä¹‰ç»å…¸æ¨¡å¼ã€ä¿®æ”¹æ•°æ®åº“
- [x] **é˜¶æ®µä¸€**: å®ç°ç»å…¸æ¨¡å¼åŒ¹é…
- [x] **é˜¶æ®µäºŒ**: æ•°æ®å‡†å¤‡å·¥å…·å’Œè„šæœ¬
- [x] **é˜¶æ®µä¸‰**: AIå‘ç°æ–°æ¨¡å¼è„šæœ¬
- [x] **é˜¶æ®µå››**: å®ç°éªŒè¯æµç¨‹ï¼ˆç¨‹åºé¢„ç­›é€‰ï¼‰
- [x] **é˜¶æ®µäº”**: å†å²å›æµ‹éªŒè¯è„šæœ¬
- [x] **é˜¶æ®µå…­**: å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
- [ ] **æ‰§è¡Œé˜¶æ®µäºŒ**: è¿è¡Œ filter_classic_samples.py ç”Ÿæˆæ•°æ®
- [ ] **æ‰§è¡Œé˜¶æ®µä¸‰**: è¿è¡Œ AI è„šæœ¬ï¼ˆ$3.30ï¼‰
- [ ] **æ‰§è¡Œé˜¶æ®µäº”**: è¿è¡Œå›æµ‹éªŒè¯å‡†ç¡®ç‡
- [ ] **å¯åŠ¨å®šæ—¶ä»»åŠ¡**: é…ç½®å’Œå¯åŠ¨ scheduler
- [ ] **æ–‡æ¡£æ›´æ–°**: å°†æ–¹æ¡ˆåæ˜ åˆ°æ¦‚è¦è®¾è®¡ä¹¦ï¼ˆHTMLç‰ˆï¼‰

---

## ğŸ’¡ é‡è¦æé†’

### å‚æ•°ä¸€è‡´æ€§åŸåˆ™

| å‚æ•° | åœºæ™¯ä¸€ | åœºæ™¯äºŒ | å¿…é¡»ä¸€è‡´ |
|------|--------|--------|---------|
| æ¶¨å¹…æ ‡å‡† | 6% | 6% | âœ… å¿…é¡» |
| æ—¶é—´çª—å£ | T+2æ—¥ | T+2æ—¥ | âœ… å¿…é¡» |
| æˆäº¤é‡çª—å£ | 20æ—¥å‡é‡ | 20æ—¥å‡é‡ | âœ… å¿…é¡» |

### è´¹ç”¨æ§åˆ¶

- åœºæ™¯ä¸€æ¯æœˆè¿è¡Œ1æ¬¡ï¼ˆæœˆåˆï¼‰
- åœºæ™¯äºŒæ¯æ—¥è¿è¡Œï¼ˆäº¤æ˜“æ—¥æ”¶ç›˜åï¼‰
- æ€»é¢„ç®—ï¼š$3.60/æœˆ
- å¦‚è¶…é¢„ç®—ï¼Œä¼˜å…ˆä¿è¯åœºæ™¯äºŒï¼ˆéªŒè¯ï¼‰ï¼Œæš‚åœåœºæ™¯ä¸€ï¼ˆæå–ï¼‰

### è´¨é‡æ ‡å‡†

- æ¯ä¸ªæ¨¡å¼è‡³å°‘æœ‰20ä¸ªè®­ç»ƒæ ·æœ¬æ”¯æ’‘
- å†å²å›æµ‹å‡†ç¡®ç‡â‰¥40%æ‰æ ‡è®°ä¸ºå¯ç”¨
- æœˆåº¦éªŒè¯æ ·æœ¬æ•°â‰¥100ä¸ªï¼ˆç´¯ç§¯ç»Ÿè®¡ï¼‰

---

## ğŸ“ é—®é¢˜è®°å½•

ï¼ˆè®°å½•å®æ–½è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼‰

---

## ğŸ“¦ æœ¬æ¬¡å·²åˆ›å»ºæ–‡ä»¶æ¸…å•ï¼ˆ2025-12-10ï¼‰

### æ–°å»ºæ–‡ä»¶ï¼ˆå…±9ä¸ªï¼‰
1. `classic_patterns.json` - 3ä¸ªç»å…¸æ¨¡å¼å®šä¹‰ï¼ˆP001-P003ï¼‰
2. `backend/app/pattern_matcher.py` - ç¨‹åºåŒ–æ¨¡å¼åŒ¹é…å™¨
3. `backend/app/scheduler.py` - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
4. `backend/scripts/filter_classic_samples.py` - è¿‡æ»¤ç»å…¸æ ·æœ¬è„šæœ¬
5. `backend/scripts/classify_special_samples.py` - Haikuåˆ†ç±»è„šæœ¬ï¼ˆ$0.80ï¼‰
6. `backend/scripts/extract_new_patterns.py` - Sonnetæå–æ–°æ¨¡å¼è„šæœ¬ï¼ˆ$2.50ï¼‰
7. `backend/scripts/merge_patterns.py` - åˆå¹¶æ¨¡å¼åˆ°æ•°æ®åº“è„šæœ¬
8. `backend/scripts/backtest_patterns.py` - å†å²å›æµ‹éªŒè¯è„šæœ¬

### ä¿®æ”¹æ–‡ä»¶ï¼ˆå…±2ä¸ªï¼‰
1. `backend/app/database.py`
   - æ–°å¢å­—æ®µï¼špattern_id, pattern_type, parameters, match_rules, is_active
   - æ–°å¢å‡½æ•°ï¼šsave_classic_patterns(), get_samples_with_context()
   - ä¿®æ”¹å‡½æ•°ï¼šget_rising_samples() å¢å¼ºç­›é€‰æ¡ä»¶

2. `backend/app/analyzer.py`
   - å¯¼å…¥ï¼špattern_matcher æ¨¡å—
   - ä¿®æ”¹å‡½æ•°ï¼špredict_stock_probability() å¢åŠ ç¨‹åºé¢„ç­›é€‰åŠŸèƒ½

---

## ğŸ‰ å¼€å‘å·¥ä½œå®Œæˆæ€»ç»“

**æ‰€æœ‰6ä¸ªé˜¶æ®µçš„å¼€å‘å·¥ä½œå·²å…¨éƒ¨å®Œæˆï¼**

âœ… é˜¶æ®µé›¶ï¼šç»å…¸æ¨¡å¼å®šä¹‰ã€æ•°æ®åº“æ‰©å±•
âœ… é˜¶æ®µä¸€ï¼šåŒ¹é…å™¨å®ç°
âœ… é˜¶æ®µäºŒï¼šæ•°æ®å‡†å¤‡å·¥å…·
âœ… é˜¶æ®µä¸‰ï¼šAIåˆ†æè„šæœ¬
âœ… é˜¶æ®µå››ï¼šç¨‹åºé¢„ç­›é€‰
âœ… é˜¶æ®µäº”ï¼šå†å²å›æµ‹
âœ… é˜¶æ®µå…­ï¼šå®šæ—¶ä»»åŠ¡

**ä¸‹ä¸€æ­¥å·¥ä½œ**ï¼š
1. ç¡®ä¿æ•°æ®åº“æœ‰è‚¡ç¥¨æ•°æ®
2. è¿è¡Œ filter_classic_samples.py ç”Ÿæˆç‰¹æ®Šæ ·æœ¬
3. è¿è¡Œ AI è„šæœ¬æå–æ–°æ¨¡å¼ï¼ˆè´¹ç”¨ $3.30ï¼‰
4. è¿è¡Œå›æµ‹éªŒè¯å‡†ç¡®ç‡
5. å¯åŠ¨å®šæ—¶ä»»åŠ¡

---

**æœ€åæ›´æ–°**: 2025-12-11

---

## ğŸ”¥ é‡å¤§çªç ´ï¼ç»å…¸æ¨¡å¼ä¼˜åŒ–å®Œæˆï¼ˆ2025-12-11ï¼‰

### é—®é¢˜å‘ç°
é€šè¿‡Opus 4.5æ·±åº¦å®¡æŸ¥,å‘ç°pattern_matcher.pyå­˜åœ¨**è‡´å‘½bug**:
- P001è¦æ±‚â‰¥21å¤©æ•°æ®,ä½†æ ·æœ¬åªæœ‰10-14å¤© â†’ 100%è¢«æ‹’ç»
- P002è¦æ±‚â‰¥16å¤©æ•°æ®,ä½†94.7%æ ·æœ¬åªæœ‰14å¤© â†’ 100%è¢«æ‹’ç»

### ä¼˜åŒ–ç»“æœ
| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| ç»å…¸è¦†ç›–ç‡ | 5.7% (16/282) | **62.4% (176/282)** | **+1000%** |
| AIåˆ†ææˆæœ¬ | $3.11 | **$1.24** | **èŠ‚çœ60%** |

### æ¨¡å¼åŒ¹é…åˆ†å¸ƒ
- P001 (ç¼©é‡éœ‡è¡åæ”¾é‡çªç ´): 114ä¸ªæ ·æœ¬ (40.4%)
- P002 (Vå‹åè½¬æ”¾é‡ä¸Šæ”»): 118ä¸ªæ ·æœ¬ (41.8%)
- P003 (è¿ç»­æ”¾é‡ä¸Šæ”»): 16ä¸ªæ ·æœ¬ (5.7%)
- æ¨¡å¼é‡å : 68ä¸ªæ ·æœ¬åŒ¹é…2-3ä¸ªæ¨¡å¼

---

## ğŸ“‹ Opuså®¡æŸ¥å»ºè®®ä¸ä¼˜åŒ–æ–¹æ¡ˆï¼ˆ2025-12-11ï¼‰

### å…³é”®æ”¹è¿›å»ºè®®

**å¿…é¡»æ”¹è¿›ï¼ˆå·²çº³å…¥ä¼˜åŒ–æ–¹æ¡ˆAï¼‰**:
1. âœ… é˜¶æ®µä¸‰æ”¹ç”¨ç¨‹åºåŒ–èšç±»ï¼ˆK-meansï¼‰æ›¿ä»£Haikuåˆ†ç±»
   - æˆæœ¬: $0.10 â†’ $0
   - ä¼˜ç‚¹: å¯å¤ç°ã€æ›´ç§‘å­¦

2. â³ ä¿®å¤å›æµ‹æ—¥æœŸè®¡ç®—bugï¼ˆä½¿ç”¨äº¤æ˜“æ—¥å†ï¼‰
   - é—®é¢˜: date('+2 days')è·³è¿‡éäº¤æ˜“æ—¥
   - å½±å“: T+2å‡†ç¡®ç‡è®¡ç®—ä¸å‡†ç¡®

3. âœ… è°ƒæ•´æ‰§è¡Œé¡ºåº: 3â†’4â†’**6â†’5**ï¼ˆå…ˆå›æµ‹ååˆå¹¶ï¼‰
   - é¿å…å°†æ— æ•ˆæ¨¡å¼åˆå¹¶åˆ°æ•°æ®åº“

**å»ºè®®æ”¹è¿›ï¼ˆå¯é€‰ï¼‰**:
- æ‰©å±•æ ·æœ¬é‡300â†’500ï¼ˆæé«˜ç»Ÿè®¡æ˜¾è‘—æ€§ï¼‰
- è®¾è®¡é€šç”¨è§„åˆ™å¼•æ“ï¼ˆæ”¯æŒAIæ–°æ¨¡å¼çš„ç¨‹åºåŒ–åŒ¹é…ï¼‰
- å¢åŠ é˜¶æ®µ2.5ï¼šæ•°æ®éªŒè¯ä¸ç‰¹å¾å·¥ç¨‹

### ä¼˜åŒ–åæ‰§è¡Œè®¡åˆ’ï¼ˆæ–¹æ¡ˆA'ï¼‰

```
ã€ç¬¬1æ­¥ã€‘é˜¶æ®µ2.5ï¼šæ•°æ®éªŒè¯ä¸ç‰¹å¾å·¥ç¨‹ï¼ˆæ–°å¢ï¼Œ1å°æ—¶ï¼‰
â”œâ”€ æ£€æŸ¥106ä¸ªç‰¹æ®Šæ ·æœ¬çš„æ•°æ®è´¨é‡
â”œâ”€ æå–æ•°å€¼ç‰¹å¾å‘é‡ï¼ˆæ³¢åŠ¨ç‡ã€é‡æ¯”ã€åŠ¨é‡ç­‰ï¼‰
â””â”€ è¾“å‡ºfeature_vectors.json

ã€ç¬¬2æ­¥ã€‘é˜¶æ®µä¸‰'ï¼šç¨‹åºåŒ–èšç±»ï¼ˆæ”¹è¿›ï¼Œ30åˆ†é’Ÿï¼‰
â”œâ”€ ç”¨sklearn K-meansèšç±»ç‰¹æ®Šæ ·æœ¬
â”œâ”€ ç¡®å®šæœ€ä¼˜ç°‡æ•°ï¼ˆ3-5ä¸ªï¼‰
â””â”€ è¾“å‡ºclustered_samples.json
   æˆæœ¬: $0ï¼ˆçœ$0.10ï¼‰

ã€ç¬¬3æ­¥ã€‘é˜¶æ®µå››ï¼šAIæå–æ¨¡å¼ï¼ˆä¿æŒï¼‰
â”œâ”€ å¯¹æ¯ä¸ªç°‡ï¼ˆâ‰¥10ä¸ªæ ·æœ¬ï¼‰ç”¨Sonnet 4.5åˆ†æ
â”œâ”€ æå–å…±æ€§ç‰¹å¾å®šä¹‰æ–°æ¨¡å¼
â””â”€ è¾“å‡ºnew_patterns.json
   æˆæœ¬: $0.20-0.30ï¼ˆä¼˜åŒ–åï¼‰

ã€ç¬¬4æ­¥ã€‘é˜¶æ®µå…­ï¼šå…ˆå›æµ‹éªŒè¯ï¼ˆè°ƒæ•´é¡ºåºï¼‰
â”œâ”€ å¯¹æ–°æ¨¡å¼å¿«é€Ÿå›æµ‹
â”œâ”€ ç­›é€‰å‡†ç¡®ç‡â‰¥45%çš„æ¨¡å¼
â””â”€ è¾“å‡ºvalidation_report.json

ã€ç¬¬5æ­¥ã€‘é˜¶æ®µäº”ï¼šåˆå¹¶æœ‰æ•ˆæ¨¡å¼ï¼ˆæœ€åï¼‰
â”œâ”€ åªåˆå¹¶ç»è¿‡éªŒè¯çš„æ¨¡å¼
â””â”€ è¾“å‡ºfinal_patterns.jsonä¿å­˜åˆ°æ•°æ®åº“
```

### ä¼˜åŒ–åæˆæœ¬

| é¡¹ç›® | åŸä¼°ç®— | ä¼˜åŒ–å | èŠ‚çœ |
|------|--------|--------|------|
| é˜¶æ®µä¸‰ (èšç±») | $0.10 | **$0** | $0.10 |
| é˜¶æ®µå›› (æå–) | $0.40 | **$0.20-0.30** | $0.10-0.20 |
| **æ€»è®¡** | **$3.30** | **$0.20-0.30** | **$3.00-3.10 (èŠ‚çœ91%)** |

æ³¨: å®é™…æ‰§è¡Œä¸­,é˜¶æ®µä¸‰å·²å®Œæˆ(106ä¸ªç‰¹æ®Šæ ·æœ¬),åç»­åªéœ€æ‰§è¡Œé˜¶æ®µå››-äº”ã€‚

---

**ä¸‹æ¬¡å¼€å§‹**: æ‰§è¡Œä¼˜åŒ–æ–¹æ¡ˆA - é˜¶æ®µ2.5ç‰¹å¾å·¥ç¨‹

---

## ğŸ¨ Kçº¿å›¾å¯è§†åŒ–åŠŸèƒ½å¼€å‘ï¼ˆ2025-12-12ï¼‰

### ğŸ“Œ å½“å‰çŠ¶æ€

**å¼€å‘é˜¶æ®µ**: å‰ç«¯Kçº¿å›¾é›†æˆ - **æœªå®Œæˆ**

**æœ€åæ›´æ–°**: 2025-12-12 ä¸‹åˆ

### ğŸ¯ åŠŸèƒ½ç›®æ ‡

åœ¨"ä¸Šæ¶¨æ¨¡å¼åˆ†æ"tabçš„"å®Œæ•´æ¨¡å¼åº“"åŒºåŸŸï¼Œä¸ºæ¯ä¸ªå·²è¯†åˆ«çš„æ¨¡å¼æ·»åŠ Kçº¿å›¾å¯è§†åŒ–åŠŸèƒ½ï¼š
- ç‚¹å‡»æ¨¡å¼åç§°å±•å¼€è¯¦æƒ…æ—¶ï¼Œæ˜¾ç¤ºè¯¥æ¨¡å¼çš„ç¤ºä¾‹Kçº¿å›¾
- Kçº¿å›¾åŒ…å«ï¼š30å¤©OHLCVæ•°æ® + ç‰¹å¾æ ‡æ³¨ç‚¹ï¼ˆé«˜ç‚¹ã€ä½ç‚¹ã€æˆäº¤é‡çªç ´ç­‰ï¼‰
- åŒæ—¶æ”¯æŒ"ç»å…¸Kçº¿å½¢æ€"å’Œ"AIæ•°å€¼ç‰¹å¾"ä¸¤ç±»æ¨¡å¼

### âœ… å·²å®Œæˆå·¥ä½œ

#### 1. å‰ç«¯ç»„ä»¶å¼€å‘
**æ–‡ä»¶**: [frontend/components/DataAnalyzer.tsx](frontend/components/DataAnalyzer.tsx)

**æ–°å¢åŠŸèƒ½**:
- âœ… æ·»åŠ KLineDataã€Annotationã€VisualizationDataæ¥å£å®šä¹‰ (lines 15-41)
- âœ… æ·»åŠ Kçº¿å›¾å¯è§†åŒ–çŠ¶æ€ç®¡ç† (lines 65-67)
  - expandedPatterns: è®°å½•å“ªäº›æ¨¡å¼è¢«å±•å¼€
  - visualizationData: ç¼“å­˜å·²åŠ è½½çš„Kçº¿æ•°æ®
  - loadingVisualizations: è®°å½•æ­£åœ¨åŠ è½½çš„æ¨¡å¼
- âœ… å®ç°loadVisualizationå‡½æ•° (lines 314-337)
  - æ‡’åŠ è½½ï¼šåªåœ¨å±•å¼€æ—¶è¯·æ±‚æ•°æ®
  - ç¼“å­˜æœºåˆ¶ï¼šé¿å…é‡å¤è¯·æ±‚
  - è°ƒç”¨åç«¯API: `/api/training/patterns/{pattern_name}/visualization`
- âœ… å®ç°togglePatternExpansionå‡½æ•° (lines 340-350)
  - åˆ‡æ¢å±•å¼€/æ”¶èµ·çŠ¶æ€
  - è‡ªåŠ¨è§¦å‘æ•°æ®åŠ è½½
- âœ… åˆ›å»ºSimpleKLineChart SVGç»„ä»¶ (lines 841-1008)
  - å‚è€ƒ[page.tsx](frontend/app/page.tsx)çš„å·¥ä½œå®ç°
  - SVGæ¸²æŸ“ï¼ˆéCanvasï¼‰
  - çº¢æ¶¨ç»¿è·Œèœ¡çƒ›å›¾
  - æˆäº¤é‡æŸ±çŠ¶å›¾
  - æ‚¬æµ®æç¤ºæ¡†
  - ç‰¹å¾æ ‡æ³¨ç‚¹ï¼ˆé«˜ç‚¹ã€ä½ç‚¹ã€æˆäº¤é‡ã€çªç ´ã€æ•´ç†ï¼‰
- âœ… åœ¨ä¸¤å¤„é›†æˆKçº¿å›¾æ˜¾ç¤º (lines 718-739, 786-811)
  - ç»å…¸Kçº¿å½¢æ€æ¨¡å¼åŒºåŸŸ
  - AIæ•°å€¼ç‰¹å¾æ¨¡å¼åŒºåŸŸ

#### 2. å‰ç«¯ç¯å¢ƒä¿®å¤
**é—®é¢˜**: é¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œ404é”™è¯¯
**è§£å†³**:
- âœ… é‡å¯å‰ç«¯dev server
- âœ… TypeScriptç¼–è¯‘æˆåŠŸï¼ˆæ— é”™è¯¯ï¼‰
- âœ… Next.jsæœåŠ¡å™¨æ­£å¸¸è¿è¡Œåœ¨http://localhost:3000
- âœ… é¡µé¢æ­£å¸¸åŠ è½½

### âŒ æœªå®Œæˆå·¥ä½œ

#### 1. åç«¯APIç«¯ç‚¹æœªç”Ÿæ•ˆ
**é—®é¢˜**: å¯è§†åŒ–ç«¯ç‚¹è¿”å›"Invalid HTTP request received"

**æ ¹æœ¬åŸå› **:
- åç«¯ä»£ç å·²å­˜åœ¨: [backend/app/routers/pattern_training.py:906](backend/app/routers/pattern_training.py#L906)
- ä½†åç«¯æœåŠ¡å™¨éœ€è¦é‡å¯æ‰èƒ½åŠ è½½æ–°ç«¯ç‚¹
- uvicorn --reloadè‡ªåŠ¨é‡è½½æœªç”Ÿæ•ˆ

**å¾…æ‰§è¡Œ**:
```bash
# éœ€è¦æ‰‹åŠ¨é‡å¯åç«¯
cd backend
# ç»ˆæ­¢å½“å‰è¿›ç¨‹
# é‡æ–°å¯åŠ¨: ./start_api.bat æˆ– uvicorn app.main:app --reload
```

#### 2. Kçº¿å›¾æœªåœ¨å‰ç«¯æ˜¾ç¤º
**çŠ¶æ€**: åŠŸèƒ½å·²é›†æˆï¼Œä½†å› åç«¯APIæœªç”Ÿæ•ˆï¼Œå‰ç«¯æ— æ³•è·å–æ•°æ®

**éªŒè¯æ–¹æ³•**ï¼ˆåç«¯é‡å¯åï¼‰:
1. æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000
2. åˆ‡æ¢åˆ°"ä¸Šæ¶¨æ¨¡å¼åˆ†æ"tab
3. æ»šåŠ¨åˆ°"å®Œæ•´æ¨¡å¼åº“"åŒºåŸŸ
4. ç‚¹å‡»ä»»ä¸€æ¨¡å¼åç§°å±•å¼€
5. åº”æ˜¾ç¤ºKçº¿å›¾ç¤ºä¾‹ï¼ˆå¦‚æœåç«¯è¿”å›æ•°æ®ï¼‰

### ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

#### åç«¯APIç«¯ç‚¹
**ä½ç½®**: [backend/app/routers/pattern_training.py:906](backend/app/routers/pattern_training.py#L906)

**è·¯ç”±**: `GET /api/training/patterns/{pattern_name}/visualization`

**åŠŸèƒ½**:
1. ä»pattern_validation.jsonè¯»å–æ¨¡å¼æ•°æ®
2. ä»æ•°æ®åº“éšæœºé€‰å–ä¸€ä¸ªåŒ¹é…è¯¥æ¨¡å¼çš„è‚¡ç¥¨æ ·æœ¬
3. æå–30å¤©Kçº¿æ•°æ®ï¼ˆOHLCVï¼‰
4. ç”Ÿæˆç‰¹å¾æ ‡æ³¨ç‚¹ï¼ˆåŸºäºæ¨¡å¼ç‰¹å¾ï¼‰
5. è¿”å›JSONæ ¼å¼æ•°æ®

**è¿”å›æ ¼å¼**:
```json
{
  "success": true,
  "data": {
    "pattern_name": "è¿ç»­æ”¾é‡ä¸Šæ”»",
    "stock_code": "600519",
    "date_range": {
      "start": "2024-11-01",
      "end": "2024-11-30"
    },
    "kline_data": [
      {
        "date": "2024-11-01",
        "open": 100.5,
        "high": 102.3,
        "low": 99.8,
        "close": 101.2,
        "volume": 1500000
      }
      // ... 30å¤©æ•°æ®
    ],
    "annotations": [
      {
        "date": "2024-11-15",
        "price": 105.6,
        "label": "é«˜ç‚¹",
        "type": "high"
      }
      // ... ç‰¹å¾æ ‡æ³¨
    ]
  }
}
```

#### å‰ç«¯Kçº¿å›¾ç»„ä»¶ç‰¹ç‚¹
**æ¸²æŸ“æ–¹å¼**: SVGï¼ˆéCanvasï¼‰
- ä¼˜ç‚¹ï¼šDOMå…ƒç´ ï¼Œæ˜“äºäº¤äº’ï¼Œæ”¯æŒhoveræ•ˆæœ
- å‚è€ƒå®ç°ï¼š[page.tsx:1057-1359](frontend/app/page.tsx#L1057-L1359)

**è§†è§‰æ ·å¼**:
- çº¢æ¶¨ï¼ˆç©ºå¿ƒçº¢æ¡†ï¼‰+ ç»¿è·Œï¼ˆå®å¿ƒç»¿è‰²ï¼‰
- ä»·æ ¼ç½‘æ ¼çº¿ + Yè½´æ ‡ç­¾
- æˆäº¤é‡æŸ±çŠ¶å›¾ï¼ˆçº¢/ç»¿åŠé€æ˜ï¼‰
- ç‰¹å¾æ ‡æ³¨ç‚¹ï¼ˆ5ç§é¢œè‰²ï¼‰
- æ‚¬æµ®æç¤ºæ¡†ï¼ˆæ˜¾ç¤ºOHLCVè¯¦æƒ…ï¼‰

**å°ºå¯¸é…ç½®**:
- æ€»å®½åº¦: 1000px
- Kçº¿å›¾é«˜åº¦: 250px
- æˆäº¤é‡å›¾é«˜åº¦: 80px
- å·¦è¾¹è·: 50pxï¼ˆä»·æ ¼æ ‡ç­¾ï¼‰
- å³è¾¹è·: 80pxï¼ˆç•™ç™½ï¼‰

### ğŸ“‹ ä¸‹æ¬¡å·¥ä½œæ¸…å•

**ä¼˜å…ˆçº§1: æ¿€æ´»åç«¯API**
1. é‡å¯åç«¯æœåŠ¡å™¨
   ```bash
   cd backend
   # Windows: Ctrl+Cç»ˆæ­¢å½“å‰è¿›ç¨‹
   ./start_api.bat
   # æˆ–: set PYTHONIOENCODING=utf-8 && uvicorn app.main:app --reload
   ```
2. éªŒè¯APIå¯è®¿é—®
   ```bash
   curl "http://localhost:8000/api/training/patterns/è¿ç»­æ”¾é‡ä¸Šæ”»/visualization"
   ```
3. æ£€æŸ¥è¿”å›æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®

**ä¼˜å…ˆçº§2: å‰ç«¯åŠŸèƒ½éªŒè¯**
1. æ‰“å¼€æµè§ˆå™¨ http://localhost:3000
2. åˆ‡æ¢åˆ°"ä¸Šæ¶¨æ¨¡å¼åˆ†æ"tab
3. ç‚¹å‡»å±•å¼€æ¨¡å¼ï¼ŒéªŒè¯Kçº¿å›¾æ˜¾ç¤º
4. æ£€æŸ¥äº¤äº’åŠŸèƒ½ï¼š
   - [ ] æ‚¬æµ®æç¤ºæ¡†
   - [ ] ç‰¹å¾æ ‡æ³¨ç‚¹æ˜¾ç¤º
   - [ ] æˆäº¤é‡å›¾æ˜¾ç¤º
   - [ ] åŠ è½½åŠ¨ç”»

**ä¼˜å…ˆçº§3: é—®é¢˜æ’æŸ¥ï¼ˆå¦‚æœä¸æ˜¾ç¤ºï¼‰**
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æŸ¥çœ‹Networkæ ‡ç­¾ï¼Œç¡®è®¤APIè¯·æ±‚ï¼š
   - è¯·æ±‚æ˜¯å¦å‘é€ï¼Ÿ
   - çŠ¶æ€ç æ˜¯å¦200ï¼Ÿ
   - è¿”å›æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Ÿ
3. æŸ¥çœ‹Consoleæ ‡ç­¾ï¼Œæ£€æŸ¥JavaScripté”™è¯¯
4. æ£€æŸ¥åç«¯æ—¥å¿—è¾“å‡º

### ğŸ› å·²çŸ¥é—®é¢˜

**é—®é¢˜1**: åç«¯å¯è§†åŒ–APIæœªç”Ÿæ•ˆ
- çŠ¶æ€: å¾…è§£å†³
- å½±å“: Kçº¿å›¾æ— æ³•åŠ è½½
- è§£å†³æ–¹æ¡ˆ: é‡å¯åç«¯

**é—®é¢˜2**: å‰ç«¯æ›¾å‡ºç°404é”™è¯¯
- çŠ¶æ€: âœ… å·²è§£å†³
- è§£å†³æ–¹æ³•: é‡å¯å‰ç«¯dev server

### ğŸ’¾ ç›¸å…³æ–‡ä»¶ä¿®æ”¹è®°å½•

**ä¿®æ”¹çš„æ–‡ä»¶**:
1. [frontend/components/DataAnalyzer.tsx](frontend/components/DataAnalyzer.tsx) - ä¸»è¦ä¿®æ”¹
   - æ–°å¢æ¥å£å®šä¹‰
   - æ–°å¢çŠ¶æ€ç®¡ç†
   - æ–°å¢åŠ è½½å‡½æ•°
   - æ–°å¢SimpleKLineChartç»„ä»¶
   - åœ¨ä¸¤å¤„é›†æˆå¯è§†åŒ–

**æ¶‰åŠçš„æ–‡ä»¶**ï¼ˆæœªä¿®æ”¹ï¼Œä»…å‚è€ƒï¼‰:
1. [frontend/app/page.tsx](frontend/app/page.tsx) - Kçº¿å›¾å‚è€ƒå®ç°
2. [backend/app/routers/pattern_training.py](backend/app/routers/pattern_training.py) - åç«¯API
3. [frontend/components/KLineChart.tsx](frontend/components/KLineChart.tsx) - åºŸå¼ƒçš„Canvasç‰ˆæœ¬ï¼ˆæœªä½¿ç”¨ï¼‰

### ğŸ“– å‚è€ƒèµ„æ–™

**Kçº¿å›¾å®ç°å‚è€ƒ**: [page.tsx](frontend/app/page.tsx) çš„"æ¨èè‚¡ç¥¨"tab
- SVGèœ¡çƒ›å›¾æ¸²æŸ“
- çº¢æ¶¨ç»¿è·Œé…è‰²æ–¹æ¡ˆ
- æ‚¬æµ®äº¤äº’æ•ˆæœ
- æ ‡æ³¨ç‚¹æ˜¾ç¤º

**åç«¯APIè®¾è®¡**: [pattern_training.py:906](backend/app/routers/pattern_training.py#L906)
- æ¨¡å¼æ•°æ®åŠ è½½
- æ ·æœ¬é€‰æ‹©é€»è¾‘
- Kçº¿æ•°æ®æå–
- ç‰¹å¾æ ‡æ³¨ç”Ÿæˆ

---

**æœ€åæ›´æ–°**: 2025-12-12 ä¸‹åˆ
**ä¸‹æ¬¡ç»§ç»­**: é‡å¯åç«¯ â†’ éªŒè¯API â†’ æµ‹è¯•Kçº¿å›¾æ˜¾ç¤º

---

## ğŸ”§ Tab 2å·¥ä½œæµä¿®å¤å®Œæˆï¼ˆ2025-12-12 æ™šï¼‰

### ğŸ“Œ å½“å‰çŠ¶æ€

**ä¿®å¤é˜¶æ®µ**: Opuså®¡æŸ¥é—®é¢˜ä¿®å¤ - **å·²å®Œæˆ**

**æœ€åæ›´æ–°**: 2025-12-12 æ™š

### âœ… å·²ä¿®å¤çš„3ä¸ªé«˜ä¼˜å…ˆçº§é—®é¢˜

#### é—®é¢˜1: ç¼ºå°‘æ­¥éª¤6 - åˆå¹¶æœ‰æ•ˆæ¨¡å¼åˆ°æ•°æ®åº“ âœ…

**åç«¯ä¿®æ”¹** ([pattern_training.py](backend/app/routers/pattern_training.py)):
- **Line 472-474**: ç§»é™¤æ­¥éª¤4çš„è‡ªåŠ¨åˆå¹¶é€»è¾‘
- **Line 619-641**: ä¿®æ”¹éªŒè¯é€»è¾‘ï¼ŒåŒæ—¶åŠ è½½ç»å…¸+AIæ¨¡å¼
- **Line 1103-1221**: æ–°å¢ `/merge-valid-patterns` POSTç«¯ç‚¹
  - è¯»å– `pattern_validation.json` éªŒè¯ç»“æœ
  - ç­›é€‰ `success_rate >= 45%` çš„æœ‰æ•ˆæ¨¡å¼
  - é€šè¿‡ `db.save_classic_patterns()` åˆå¹¶åˆ°æ•°æ®åº“
  - è®¾ç½®ä½å‡†ç¡®ç‡æ¨¡å¼ `is_active = 0`
- **Line 919-933**: æ–°å¢ `/results/merge-result` GETç«¯ç‚¹

**å‰ç«¯ä¿®æ”¹** ([DataAnalyzer.tsx](frontend/components/DataAnalyzer.tsx)):
- **Line 318-331**: æ–°å¢ `handleMergeValidPatterns()` å‡½æ•°
- **Line 195-200**: è½®è¯¢é€»è¾‘æ”¯æŒ `merge_valid_patterns` ä»»åŠ¡
- **Line 689-757**: æ–°å¢æ­¥éª¤6 UIåŒºåŸŸï¼ˆæŒ‰é’®+ç»“æœå±•ç¤ºï¼‰

**åŠŸèƒ½è¯´æ˜**:
- åªåˆå¹¶éªŒè¯é€šè¿‡çš„æ¨¡å¼ï¼ˆå‡†ç¡®ç‡â‰¥45%ï¼‰
- è‡ªåŠ¨æ·˜æ±°ä½æ•ˆæ¨¡å¼ï¼ˆå‡†ç¡®ç‡<40%ï¼Œè®¾ç½®is_active=0ï¼‰
- é¿å…æ— æ•ˆæ¨¡å¼æ±¡æŸ“æ•°æ®åº“

#### é—®é¢˜2: T+Næ—¥æœŸè®¡ç®—ä½¿ç”¨äº¤æ˜“æ—¥ âœ…

**ä¿®æ”¹ä½ç½®**: [database.py:299-345](backend/app/database.py#L299-L345)

**é—®é¢˜æè¿°**:
- åŸé€»è¾‘ä½¿ç”¨ `date(t_base.date, '+{} days')` è¿›è¡Œæ—¥å†æ—¥è®¡ç®—
- ä¼šé”™è¯¯åœ°å°†å‘¨æœ«/èŠ‚å‡æ—¥ç®—å…¥
- å¯¼è‡´T+NéªŒè¯ç»“æœä¸å‡†ç¡®

**æ–°å®ç°é€»è¾‘**:
```python
# 1. æŸ¥è¯¢åŸºå‡†æ—¥æ”¶ç›˜ä»·
SELECT close FROM stock_data WHERE code = ? AND date = ?

# 2. æŸ¥è¯¢åŸºå‡†æ—¥ä¹‹åçš„Nä¸ªäº¤æ˜“æ—¥ï¼ˆè‡ªåŠ¨è·³è¿‡å‘¨æœ«/èŠ‚å‡æ—¥ï¼‰
SELECT date, close FROM stock_data
WHERE code = ? AND date > ?
ORDER BY date ASC
LIMIT ?

# 3. å–ç¬¬Nä¸ªäº¤æ˜“æ—¥çš„æ”¶ç›˜ä»·è®¡ç®—æ¶¨å¹…
rise_ratio = (future_close - base_close) / base_close
```

**ä¼˜ç‚¹**:
- åˆ©ç”¨æ•°æ®åº“å®é™…äº¤æ˜“æ—¥æœŸæ•°æ®
- è‡ªåŠ¨æ’é™¤å‘¨æœ«å’ŒèŠ‚å‡æ—¥
- å‡†ç¡®è®¡ç®—T+Näº¤æ˜“æ—¥æ¶¨å¹…

#### é—®é¢˜3: éªŒè¯ç»“æœåŒæ­¥åˆ°æ•°æ®åº“ âœ…

**è§£å†³æ–¹æ¡ˆ**: é€šè¿‡æ­¥éª¤6çš„å®ç°è‡ªåŠ¨è§£å†³

**åŒæ­¥æµç¨‹**:
1. æ­¥éª¤5ç”Ÿæˆ `pattern_validation.json` æ–‡ä»¶
2. æ­¥éª¤6è¯»å–éªŒè¯ç»“æœå¹¶æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼š
   - åˆå¹¶æœ‰æ•ˆæ¨¡å¼ â†’ `db.save_classic_patterns()`
   - æ·˜æ±°æ— æ•ˆæ¨¡å¼ â†’ `UPDATE rising_patterns SET is_active = 0`

**éªŒè¯çŠ¶æ€æŒä¹…åŒ–**:
- æœ‰æ•ˆæ¨¡å¼ï¼šå†™å…¥æ•°æ®åº“ï¼Œis_active=1
- æ— æ•ˆæ¨¡å¼ï¼šæ›´æ–°is_active=0ï¼ˆè½¯åˆ é™¤ï¼‰

### ğŸ“Š ä¿®å¤å½±å“

**å·¥ä½œæµå®Œæ•´æ€§**: Tab 2çš„"AIæ•°å€¼ç‰¹å¾æŒ–æ˜å·¥ä½œæµ"ç°åŒ…å«å®Œæ•´6ä¸ªæ­¥éª¤ï¼š
- âœ… æ­¥éª¤1ï¼šè¿‡æ»¤ç‰¹æ®Šæ ·æœ¬
- âœ… æ­¥éª¤2ï¼šæå–ç‰¹å¾å‘é‡
- âœ… æ­¥éª¤3ï¼šK-meansèšç±»
- âœ… æ­¥éª¤4ï¼šAIæå–æ¨¡å¼
- âœ… æ­¥éª¤5ï¼šæ¨¡å¼éªŒè¯
- âœ… **æ­¥éª¤6ï¼šåˆå¹¶æœ‰æ•ˆæ¨¡å¼**ï¼ˆæ–°å¢ï¼‰

**æ•°æ®è´¨é‡æå‡**:
- åªæœ‰ç»è¿‡éªŒè¯çš„é«˜è´¨é‡æ¨¡å¼æ‰ä¼šè¿›å…¥æ•°æ®åº“
- è‡ªåŠ¨æ·˜æ±°ä½å‡†ç¡®ç‡æ¨¡å¼ï¼Œä¿æŒæ¨¡å¼åº“è´¨é‡
- T+NéªŒè¯å‡†ç¡®ï¼Œç»“æœå¯ä¿¡

**æˆæœ¬ä¸å˜**:
- ä¿®å¤æ²¡æœ‰å¢åŠ é¢å¤–æˆæœ¬
- ä»ç„¶æ˜¯ $0.20-0.30 æ¯æ¬¡æ‰§è¡Œï¼ˆå·²ä¼˜åŒ–ï¼‰

### ğŸ¯ ä¸‹æ¬¡å·¥ä½œä»»åŠ¡

**ä»»åŠ¡**: æ‰§è¡Œå®Œæ•´çš„Tab 2å·¥ä½œæµï¼ˆé€‰é¡¹Aï¼‰

**æ‰§è¡Œæ­¥éª¤**:
1. å¯åŠ¨å‰åç«¯æœåŠ¡å™¨
2. é€šè¿‡Tab 2ç•Œé¢ä¾æ¬¡æ‰§è¡Œæ­¥éª¤1-6
3. éªŒè¯æ¯ä¸ªæ­¥éª¤çš„è¾“å‡ºç»“æœ
4. ç¡®è®¤æœ€ç»ˆæ¨¡å¼åˆå¹¶åˆ°æ•°æ®åº“

**é¢„æœŸæˆæœ¬**: $0.20-0.30

**éªŒè¯ç‚¹**:
- [ ] æ­¥éª¤1ï¼šè¿‡æ»¤å‡ºç‰¹æ®Šæ ·æœ¬ï¼ˆä¸åŒ¹é…ç»å…¸æ¨¡å¼çš„æ ·æœ¬ï¼‰
- [ ] æ­¥éª¤2ï¼šæå–ç‰¹å¾å‘é‡ï¼ˆ8ä¸ªæ•°å€¼ç‰¹å¾ï¼‰
- [ ] æ­¥éª¤3ï¼šK-meansèšç±»ï¼ˆè‡ªåŠ¨ç¡®å®šç°‡æ•°ï¼‰
- [ ] æ­¥éª¤4ï¼šAIæå–æ¨¡å¼ï¼ˆæ¯ä¸ªç°‡æå–1ä¸ªæ¨¡å¼ï¼‰
- [ ] æ­¥éª¤5ï¼šéªŒè¯æ¨¡å¼å‡†ç¡®ç‡ï¼ˆå†å²å›æµ‹ï¼‰
- [ ] æ­¥éª¤6ï¼šåˆå¹¶æœ‰æ•ˆæ¨¡å¼åˆ°æ•°æ®åº“

**æˆåŠŸæ ‡å‡†**:
- æ‰€æœ‰æ­¥éª¤æ— é”™è¯¯å®Œæˆ
- è‡³å°‘æœ‰1-2ä¸ªAIæ¨¡å¼é€šè¿‡éªŒè¯ï¼ˆå‡†ç¡®ç‡â‰¥45%ï¼‰
- æ•°æ®åº“ä¸­åŒ…å«éªŒè¯é€šè¿‡çš„æ¨¡å¼

### ğŸ’¾ ä¿®æ”¹æ–‡ä»¶æ¸…å•

**åç«¯**:
1. `backend/app/routers/pattern_training.py` - æ–°å¢æ­¥éª¤6ç«¯ç‚¹
2. `backend/app/database.py` - ä¿®å¤T+Näº¤æ˜“æ—¥è®¡ç®—

**å‰ç«¯**:
1. `frontend/components/DataAnalyzer.tsx` - æ·»åŠ æ­¥éª¤6 UI

### ğŸ“ æŠ€æœ¯æ–‡æ¡£æ›´æ–°

ä»¥ä¸‹æ–‡æ¡£å·²åŒæ­¥æ›´æ–°ï¼š
- âœ… æœ¬å·¥ä½œè®¡åˆ’æ–‡æ¡£
- â³ system_design_complete.htmlï¼ˆå¾…åç»­æ›´æ–°ï¼‰

---

**æœ€åæ›´æ–°**: 2025-12-12 æ™š
**ä¸‹æ¬¡å¼€å§‹**: å¯åŠ¨æœåŠ¡å™¨ â†’ æ‰§è¡ŒTab 2å®Œæ•´å·¥ä½œæµï¼ˆæ­¥éª¤1-6ï¼‰â†’ éªŒè¯AIæ¨¡å¼å‘ç°
