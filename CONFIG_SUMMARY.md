# 股票预测系统 - 配置总结

## 最终配置参数

本系统已按照最优性价比原则配置完成：

### 核心参数

| 参数 | 配置值 | 说明 |
|------|--------|------|
| **样本数量** | 2000个 | 用于模式分析的历史上涨案例数量 |
| **股票池大小** | 1000只 | 覆盖沪深两市主要股票 |
| **历史数据周期** | 5年 | 获取每只股票最近5年的日K线数据 |
| **模式数量** | 8-12种 | Claude AI提取的上涨模式类型 |
| **预测窗口** | 30天 | 区域3使用最近1个月的K线数据进行预测 |

---

## 成本估算

### 使用 Claude 3 Haiku 模型（推荐）

| 项目 | 频率 | 单次成本 | 月度成本 |
|------|------|----------|----------|
| **区域1：数据获取** | 每月1次 | $0 | $0 |
| **区域2：模式分析** | 每月1次 | $0.052 | $0.052 |
| **区域3：每日预测** | 每天1次 | $0.232 | $6.96 |
| **总计** | - | - | **$7.01/月** |

**人民币：约 ¥50/月**

### 如果使用 Claude 3.5 Sonnet（更准确但更贵）

| 项目 | 频率 | 单次成本 | 月度成本 |
|------|------|----------|----------|
| 区域2：模式分析 | 每月1次 | $0.62 | $0.62 |
| 区域3：每日预测 | 每天1次 | $2.78 | $83.4 |
| **总计** | - | - | **$84/月** |

**人民币：约 ¥600/月**

**结论：强烈推荐使用 Haiku 模型，性价比最优。**

---

## 系统架构

### 三区域设计

```
┌─────────────────────────────────────────────────────────────┐
│                    区域1：数据获取                           │
│  ├─ Yahoo Finance 数据源                                     │
│  ├─ 1000只股票 × 5年历史数据                                │
│  └─ 执行频率：每月1次                                        │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                    区域2：模式分析                           │
│  ├─ 提取2000个历史上涨案例                                  │
│  ├─ Claude AI分析提取8-12种上涨模式                         │
│  └─ 执行频率：每月1次                                        │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│                    区域3：相似性预测                         │
│  ├─ 使用最近30天K线数据                                      │
│  ├─ 与模式进行相似度匹配                                     │
│  ├─ 输出前100只高概率股票                                    │
│  └─ 执行频率：每天1次                                        │
└─────────────────────────────────────────────────────────────┘
```

---

## 预期效果

### 性能指标

- **预测准确率**：70-75%（基于2000样本 + Haiku模型）
- **模式覆盖度**：8-12种典型上涨模式
- **每日推荐**：前100只高概率股票
- **响应时间**：
  - 区域1：10-30分钟（1000只股票）
  - 区域2：1-3分钟（2000样本分析）
  - 区域3：3-10分钟（1000只股票预测）

### 数据规模

- **总数据量**：1000只 × 5年 × 250交易日 ≈ 125万条K线记录
- **样本池大小**：1000只 × 5年 ≈ 5000-10000个潜在上涨案例
- **提取样本**：2000个代表性案例
- **模式库**：8-12种上涨模式描述

---

## 技术栈

### 后端

- **框架**：FastAPI
- **数据库**：SQLite
- **AI模型**：Claude 3 Haiku (via Anthropic API)
- **数据源**：Yahoo Finance (yfinance)
- **数据处理**：Pandas

### 前端

- **框架**：Next.js 15 + React 19
- **UI库**：Tailwind CSS
- **HTTP客户端**：Axios

---

## 核心文件修改记录

### 已修改文件

1. **backend/app/models.py**
   - `FetchDataRequest.years`: 3 → 5
   - `AnalyzeRequest.pattern_count`: 50 → 2000

2. **backend/app/analyzer.py**
   - 修改prompt要求提取8-12种模式（原5-10种）
   - 使用最近30天数据进行预测（原10天）

3. **backend/app/data_fetcher_yfinance.py**
   - 新增 `_generate_stock_codes()` 方法生成1000只股票代码
   - 支持动态生成沪深两市股票列表

4. **backend/app/main.py**
   - 设置获取1000只股票（原160只）

5. **frontend/components/DataFetcher.tsx**
   - 修改默认获取5年数据（原3年）

6. **frontend/components/DataAnalyzer.tsx**
   - 修改默认分析2000个样本（原50个）

---

## 使用说明

### 首次运行流程

1. **启动后端服务**
   ```bash
   cd backend
   uvicorn app.main:app --reload
   ```

2. **启动前端服务**
   ```bash
   cd frontend
   npm run dev
   ```

3. **执行区域1（每月）**
   - 点击"获取上交所股票数据"
   - 等待10-30分钟
   - 确认获取到1000只股票的5年数据

4. **执行区域2（每月）**
   - 点击"分析上涨模式"
   - 等待1-3分钟
   - 确认识别出8-12种上涨模式

5. **执行区域3（每天）**
   - 点击"开始预测"
   - 等待3-10分钟
   - 查看前100只高概率股票

### 运维建议

- **区域1 + 区域2**：每月第一个交易日执行
- **区域3**：每个交易日收盘后执行
- **成本控制**：使用Haiku模型，避免频繁重复运行区域3

---

## 免责声明

⚠️ **重要提示**：

1. 本系统仅供学习和研究使用
2. 预测结果不构成任何投资建议
3. 股市有风险，投资需谨慎
4. 过往表现不代表未来收益
5. 请根据自身风险承受能力理性投资

---

## 配置生成时间

**生成日期**：2025-12-05
**配置版本**：v1.0
**模型配置**：Claude 3 Haiku
**预估准确率**：70-75%
**月度成本**：$7.01 (¥50)
